#!/bin/bash

#### Get ENV info
if [ "$(uname)" == "Darwin" ]; then
    os_type="Darwin"
    cpu_count=`sysctl -n hw.ncpu`
elif [ "$(expr substr $(uname -s) 1 5)" == "Linux" ]; then
    os_type="Linux"
    cpu_count=`lscpu | grep -e "^CPU(s):" | uniq | awk '{print $NF}'`
else
    echo "Unsupported platform. Exiting"
    exit 2
fi

#### Make a _build dir to hold boost & p2p build files
working_dir="$(pwd)/_build"
if [ ! -d $working_dir ]; then
    mkdir $working_dir
fi

#### Call Cmake
cd $working_dir && cmake -DCPU_COUNT=$cpu_count ..


